# タロット AI アプリ プロンプト設計書（完全版）

## 📋 概要

本設計書では、タロット占いアプリにおける 2 つの占い方式のプロンプト構造を定義します。

### 占い方式

1. **即答形式**：システムが選択したカードで即座に占い結果を提示
2. **AI 対話形式**：ユーザーの回答を基に対話的に占い結果を深掘り

---

## 🎯 即答形式プロンプト設計

### 実行フロー

1. ユーザーが占いカテゴリを選択
2. ユーザーがスプレッドを選択、占いボタンを押下
3. システムがスプレッドに従ってカードをランダムに選択
4. システムが選択された占いカテゴリとランダムに選択されたカード（複数）を利用してプロンプトを生成
5. 生成されたプロンプトに従って占い結果を提示

### 事前準備データ

システムは事前に以下のデータを DB から取得：

- カード位置の意味 (ex. 過去)
- カード名 (ex. the fool)
- 正・逆 (ex. 正)
- カード意味一覧(例 ["intuition", "mystery", "subconscious", "inner wisdom", "spirituality"])

### プロンプトテンプレート

```
あなたは熟練のタロット占い師です。
{スプレッド名}に従って以下のカードを使って{占いカテゴリ名}について占ってください。

n枚目:{位置の意味}:愚者:正:{カード意味一覧}
n+1枚目:{位置の意味}:世界:逆:{カード意味一覧}
...指定枚数繰り返し...

# 出力
---
n枚目のカードの解釈
...指定枚数繰り返し...
---
総合占い結果
---
```

### プロンプト例（3 枚引き Past/Present/Future）

```
あなたは熟練のタロット占い師です。
3枚引き（Past/Present/Future）に従って以下のカードを使って恋愛運について占ってください。

1枚目:過去:愚者:正:["intuition", "mystery", "subconscious", "inner wisdom", "spirituality"]

2枚目:現在:世界:逆:["incomplete", "lack of closure", "stagnation", "unfulfilled goals"]

3枚目:未来:恋人:正:["love", "union", "partnership", "choices", "harmony", "attraction", "soul mates"]

# 出力
---
1枚目のカードの解釈
---
2枚目のカードの解釈
---
3枚目のカードの解釈
---
総合占い結果
---
```

---

## 🤖 AI 対話形式プロンプト設計

### 実行フロー

1. ユーザーが占いたい内容を入力
2. ユーザーがスプレッドを手動選択するか、AI に占い内容によっておすすめを選択させる
3. 全カードをシステムが選択
4. AI が全カードの解釈を提示し、また重要な 3 カードを提示する
5. システムが、ユーザーに「重要なカードそれぞれについて思い当たることを入力してください」と質問を表示し、入力欄をカード分３つ用意する。
6. ユーザーが 3 つの入力欄にそれぞれのカードについて思い当たることを入力
7. AI がユーザーの回答を受けて、最終的な占い結果を提示

**注意事項：** 3 枚以上のスプレッドのみ選択可能

---

## ステップ 1：スプレッド推奨プロンプト

### 事前準備データ

DB より、スプレッド一覧を用意：

- DB の ID
- スプレッド名
- カテゴリー配列
- 各カードの位置の意味

（3 枚以上のスプレッドのみで構成）

### プロンプトテンプレート

```
あなたは熟練のタロット占い師です。
占いたい内容の{占いたい内容}という入力に対して、適切なスプレッドを選択してください。

[(DBのID,スプレッド名)の配列]

# 出力
{DBのID}
```

注：生成 AI は基本的にスプレッドの内容を把握しているはずなのでプロンプトには、スプレッド名＋ ID の配列だけで生成できると判断。

### プロンプト例

```
あなたは熟練のタロット占い師です。
占いたい内容の「転職すべきか悩んでいます」という入力に対して、適切なスプレッドを選択してください。

スプレッド一覧：
1. ID: スプレッド名
... (全22種類)

出力結果
{DBのID}
```

---

## ステップ 2：全カード解釈＋重要カード選択プロンプト

### 事前準備データ

ステップ 1 で選択されたスプレッドに従い、システムがカードを選択：

- 何枚目か
- カード位置の意味
- カード名
- 正・逆
- カード意味一覧

### プロンプトテンプレート

```
あなたは熟練のタロット占い師です。
{スプレッド名}に従って以下のカードを使って{占いたい内容}についてまず全カードの解釈を提示してください。
また最終的な占い結果を提示するのに当たり、重要なカードを3枚選択してください。
この後ユーザーにはその3枚のカードについて思い当たることを入力してもらいます。

カード
n:{位置の意味}:愚者:正:{カード意味一覧}
n+1:{位置の意味}:世界:逆:{カード意味一覧}
...指定枚数繰り返し...

注：カード意味一覧の例：愚者の正の場合 → ["intuition", "mystery", "subconscious", "inner wisdom", "spirituality"]

# 出力
---
n枚目のカードの解釈
...指定枚数繰り返し...
---
{カード位置番号}
{カード位置番号}
{カード位置番号}
---
```

### プロンプト例（ケルト十字）

```
あなたは熟練のタロット占い師です。
ケルト十字に従って以下のカードを使って「転職すべきか悩んでいます」についてまず全カードの解釈を提示してください。
また最終的な占い結果を提示するのに当たり、重要なカードを3枚選択してください。
この後ユーザーにその3枚のカードについて思い当たることを入力してもらいます。

1枚目:現在の状況:愚者:正:{カード意味一覧}
2枚目:課題・障害:節制:逆:{カード意味一覧}
3枚目:遠い過去:女教皇:正:{カード意味一覧}
4枚目:近い過去:ペンタクルス5:逆:{カード意味一覧}
5枚目:可能な未来:太陽:正:{カード意味一覧}
6枚目:近い未来:ワンド9:正:{カード意味一覧}
7枚目:あなたのアプローチ:ソード3:逆:{カード意味一覧}
8枚目:周囲の影響:カップの王:正:{カード意味一覧}
9枚目:内面・感情:運命の輪:正:{カード意味一覧}
10枚目:最終結果:世界:正:{カード意味一覧}

# 出力
---
愚者の正位置の解釈結果
... (10枚分)
---
太陽
運命の輪
世界
---
```

---

## ステップ 3：再解釈＋総合結果プロンプト

### 入力データ

- 前回の全カード解釈
- ユーザーの 3 つの回答

### プロンプトテンプレート

```
あなたは熟練のタロット占い師です。
前回のカード解釈と以下のユーザー入力に従って総合的な占い結果を提示してください。
ユーザー入力を対応するカード位置の再解釈に確実に反映するように注意すること。
（前回のカード解釈+ユーザー入力=>カード解釈）

---
スプレッド名
---
n枚目のカードの解釈
...指定枚数繰り返し...
---
{カード位置番号}{ユーザー入力}
{カード位置番号}{ユーザー入力}
{カード位置番号}{ユーザー入力}
---

# 出力
---
n枚目のカードの解釈（再解釈結果）
...指定枚数繰り返し...
---
総合占い結果
---
```

### プロンプト例

```
あなたは熟練のタロット占い師です。
前回のカード解釈と以下のユーザー入力に従って総合的な占い結果を提示してください。
ユーザー入力を対応するカード位置の再解釈に確実に反映するように注意すること。
（前回のカード解釈+ユーザー入力=>カード解釈）

---
ケルト十字
---
現在の状況を示す「愚者」が正位置で出ています。あなたは今、新しいキャリアへの一歩を踏み出そうとしている段階にいます...
課題として「節制」の逆位置が現れました。これは焦りや不均衡を示しています...
... (10枚分の解釈)
---
太陽について：確かに最近転職についてよく考えています
運命の輪について：転職のタイミングが近づいている感覚は確かにあります
世界について：最近焦りからか食に走る傾向があります
---

# 出力
---
ユーザーの「新しい環境で成功したい」という願望を踏まえると...(文章は生成AIに任せるが確実にユーザ入力を反映した解釈提示にしたい)
(前回の解釈を再提示 or 多少解釈結果が変わってしまっても良しとする)
... (10枚分の再解釈)
---
あなたの転職について、カードは明確なメッセージを送っています...
---
```

---

## 📝 補足：コーチングプランについて

別途コーチングプランも検討中（TBD）。デスクトップアプリや PC Web 版での実装を想定。

### 検討内容

1. ユーザーが占いたい内容を入力
2. スプレッド選択（手動 or AI 推奨）
3. 全カードシステム選択
4. AI 全カード解釈提示
5. **全カードについてユーザー入力受付**
6. 全カード再解釈＋総合結果
7. **3 回まで追加質問受付**
8. 各質問への回答

モバイルアプリでは入力が困難なため、別バージョンとして検討中。
